{% extends "base.html" %}

{% block title %}Dashboard - Instagram Chat Platform{% endblock %}

{% block head %}
<style>
    .chat-message {
        padding: 1rem;
        border-radius: 10px;
        margin: 0.5rem 0;
        max-width: 75%;
        word-wrap: break-word;
    }
    .message-received {
        background-color: #2D2D2D;
        margin-right: auto;
    }
    .message-sent {
        background-color: #0B5394;
        margin-left: auto;
    }
    .timestamp {
        font-size: 0.8em;
        color: #888888;
    }
    /* Custom scrollbar for conversation container */
    .conversation-container::-webkit-scrollbar {
        width: 6px;
    }
    .conversation-container::-webkit-scrollbar-track {
        background: #1E1E1E;
    }
    .conversation-container::-webkit-scrollbar-thumb {
        background-color: #4A4A4A;
        border-radius: 6px;
    }
    /* Add animation for new messages */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .message-new {
        animation: fadeIn 0.3s ease-out;
    }
</style>
{% endblock %}

{% block content %}
<div class="flex h-screen">
    <!-- Sidebar -->
    <div class="w-1/4 border-r border-gray-700 p-4 flex flex-col h-full">
        <h1 class="text-xl font-bold mb-4">Instagram Chats</h1>
        
        <!-- Status tabs -->
        <div class="flex mb-4 bg-gray-800 rounded-lg p-1">
            <button class="flex-1 py-2 px-4 rounded-lg bg-primary text-white text-center"
                   hx-get="{{ url_for('get_users', status='assistant') }}"
                   hx-target="#user-list"
                   hx-trigger="click, load">
                Assistant
            </button>
            <button class="flex-1 py-2 px-4 rounded-lg text-white text-center hover:bg-gray-700"
                   hx-get="{{ url_for('get_users', status='human') }}"
                   hx-target="#user-list">
                Human
            </button>
        </div>
        
        <!-- User list - will be loaded via HTMX -->
        <div id="user-list" class="flex-grow overflow-auto"></div>
    </div>
    
    <!-- Chat area -->
    <div class="w-3/4 flex flex-col h-full">
        <!-- Empty state or selected conversation will be shown here -->
        <div id="conversation" class="flex-grow p-4 flex items-center justify-center">
            <div class="text-gray-500 text-lg">
                Select a conversation from the sidebar
            </div>
        </div>
    </div>
</div>

<!-- Auto-refresh users list -->
<div hx-get="{{ url_for('get_users', status='assistant') }}" 
     hx-trigger="every 10s"
     hx-target="#user-list"
     hx-swap="innerHTML">
</div>
{% endblock %}
